# Facturación Electrónica - Implementación Simple

## ¿Qué Necesitas?

Para conectar con el API de facturación electrónica, solo necesitas estos campos esenciales:

### **Productos:**
- `codigoCabys` - Código de 12 dígitos para clasificación arancelaria
- `unidadMedida` - Unidad de medida (Kg, L, Un, ml, etc.)
- `tarifaImpuesto` - Porcentaje de IVA (13%, 8%, 4%, 2%, 1%, 0%)
- `tipoCodigo` - Tipo de producto (04 = Producto)

### **Clientes:**
- `codigoActividad` - Código de actividad económica (722003 = Restaurantes)
- `numeroIdentificacion` - Cédula del cliente
- `correo` - Correo del cliente

### **Empresa:**
- `codigoActividadEmisor` - Código de actividad económica de tu empresa

## Archivos Creados

1. **`tablas_fe_esencial.sql`** - Crea las tablas necesarias
2. **`ejemplos_uso_fe.sql`** - Ejemplos de uso y consultas útiles

## Pasos Rápidos

### 1. Ejecutar el Script
```bash
mysql -u usuario -p tu_base_datos < tablas_fe_esencial.sql
```

### 2. Ajustar Datos de Empresa
Modifica en `empresa_fe_info`:
- Tu cédula jurídica real
- Tu dirección real
- Tu teléfono real
- Tu correo real

### 3. Agregar Códigos CABYS a Productos
```sql
INSERT INTO producto_fe_info (producto_id, tipo_producto, codigo_cabys, unidad_medida, tarifa_impuesto) 
VALUES (1, 'MENU', '2118100000300', 'ml', 13.00);
```

### 4. Agregar Información FE a Clientes
```sql
INSERT INTO cliente_fe_info (cliente_id, codigo_actividad, tipo_identificacion) 
VALUES (1, '722003', '01');
```

## Códigos CABYS Comunes

- **Bebidas**: `2118100000200` (bebidas no alcohólicas)
- **Café**: `2118100000300` (café y té)
- **Alimentos**: `2118100000100` (alimentos preparados)
- **Pan**: `2118100000500` (pan y repostería)

## Códigos de Actividad

- **722003**: Restaurantes y servicios de comida
- **722004**: Bares y cantinas
- **722005**: Servicios de catering

## Validaciones Importantes

- Los códigos CABYS deben tener exactamente 12 dígitos
- Las tarifas de impuesto deben ser estándar (0%, 1%, 2%, 4%, 8%, 13%)
- Todos los productos deben tener información FE antes de facturar

## Consulta para Generar JSON

```sql
-- Obtener datos completos de una orden para facturación
SELECT o.*, c.*, efe.*, pfe.*
FROM orden o
JOIN cliente c ON o.cliente = c.id
JOIN cliente_fe_info cfe ON c.id = cfe.cliente_id
JOIN sucursal s ON o.sucursal = s.id
JOIN empresa_fe_info efe ON s.id = efe.sucursal_id
JOIN detalle_orden do ON o.id = do.orden
JOIN producto_menu pm ON do.codigo_producto = pm.codigo
JOIN producto_fe_info pfe ON pm.id = pfe.producto_id
WHERE o.id = 1;
```

## ¿Necesitas Ayuda?

1. **Verificar productos sin info FE**: Usa la consulta de verificación en `ejemplos_uso_fe.sql`
2. **Validar códigos CABYS**: Verifica que tengan 12 dígitos
3. **Revisar tarifas**: Asegúrate de que sean estándar

## Próximos Pasos

1. Ejecutar el script SQL
2. Configurar datos de tu empresa
3. Agregar códigos CABYS a productos
4. Probar con una orden simple
5. Integrar con el API de facturación
